webpackJsonp([99],{1808:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"AddonModAssignSubmissionReviewPageModule",function(){return l});var i=t(0),o=t(4),s=t(1),r=t(16),a=t(15),d=t(933),u=t(1932),c=this&&this.__decorate||function(e,n,t,i){var o,s=arguments.length,r=s<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,n,t,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(n,t,r):o(n,t))||r);return s>3&&r&&Object.defineProperty(n,t,r),r},l=function(){function e(){}return e=c([Object(i.I)({declarations:[u.a],imports:[r.a,a.a,d.a,o.l.forChild(u.a),s.b.forChild()]})],e)}()},1932:function(e,n,t){"use strict";t.d(n,"a",function(){return l});var i=t(0),o=t(4),s=t(9),r=t(10),a=t(52),d=t(401),u=this&&this.__decorate||function(e,n,t,i){var o,s=arguments.length,r=s<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,n,t,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(n,t,r):o(n,t))||r);return s>3&&r&&Object.defineProperty(n,t,r),r},c=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},l=function(){function e(e,n,t,i,o){this.navCtrl=n,this.courseProvider=t,this.appProvider=i,this.assignProvider=o,this.forceLeave=!1,this.moduleId=e.get("moduleId"),this.courseId=e.get("courseId"),this.submitId=e.get("submitId"),this.blindId=e.get("blindId"),this.showGrade=!!e.get("showGrade")}return e.prototype.ngOnInit=function(){var e=this;this.fetchSubmission().finally(function(){e.loaded=!0})},e.prototype.ionViewCanLeave=function(){return!(this.submissionComponent&&!this.forceLeave)||this.submissionComponent.canLeave()},e.prototype.ionViewDidEnter=function(){this.submissionComponent&&this.submissionComponent.ionViewDidEnter()},e.prototype.ionViewDidLeave=function(){this.submissionComponent&&this.submissionComponent.ionViewDidLeave()},e.prototype.fetchSubmission=function(){var e=this;return this.assignProvider.getAssignment(this.courseId,this.moduleId).then(function(n){return e.assign=n,e.title=e.assign.name,e.blindMarking=e.assign.blindmarking&&!e.assign.revealidentities,e.courseProvider.getModuleBasicGradeInfo(e.moduleId).then(function(n){if(n)if(n.advancedgrading&&n.advancedgrading[0]&&void 0!==n.advancedgrading[0].method){e.canSaveGrades="simple"==(n.advancedgrading[0].method||"simple")}else e.canSaveGrades=!0})})},e.prototype.refreshAllData=function(){var e=this,n=[];return n.push(this.assignProvider.invalidateAssignmentData(this.courseId)),this.assign&&(n.push(this.assignProvider.invalidateSubmissionData(this.assign.id)),n.push(this.assignProvider.invalidateAssignmentUserMappingsData(this.assign.id)),n.push(this.assignProvider.invalidateSubmissionStatusData(this.assign.id,this.submitId,this.blindMarking))),Promise.all(n).finally(function(){return e.submissionComponent&&e.submissionComponent.invalidateAndRefresh(),e.fetchSubmission()})},e.prototype.refreshSubmission=function(e){this.refreshAllData().finally(function(){e.complete()})},e.prototype.submitGrade=function(){var e=this;this.submissionComponent&&this.submissionComponent.submitGrade().then(function(){e.appProvider.isWide()||(e.forceLeave=!0,e.navCtrl.pop())})},u([Object(i._9)(d.a),c("design:type",d.a)],e.prototype,"submissionComponent",void 0),e=u([Object(i.m)({selector:"page-addon-mod-assign-submission-review",template:'<ion-header>\n    <ion-navbar>\n        <ion-title><core-format-text [text]="title"></core-format-text></ion-title>\n\n        <ion-buttons end></ion-buttons>\n    </ion-navbar>\n\n    <core-navbar-buttons end>\n        <button [hidden]="!canSaveGrades" ion-button button-clear (click)="submitGrade()" [attr.aria-label]="\'core.done\' | translate">\n            {{ \'core.done\' | translate }}\n        </button>\n    </core-navbar-buttons>\n</ion-header>\n<ion-content>\n\n    <ion-refresher [enabled]="loaded" (ionRefresh)="refreshSubmission($event)">\n        <ion-refresher-content pullingText="{{ \'core.pulltorefresh\' | translate }}"></ion-refresher-content>\n    </ion-refresher>\n    <core-loading [hideUntil]="loaded">\n        <addon-mod-assign-submission [courseId]="courseId" [moduleId]="moduleId" [submitId]="submitId" [blindId]="blindId" [showGrade]="showGrade"></addon-mod-assign-submission>\n    </core-loading>\n</ion-content>\n'}),c("design:paramtypes",[o.r,o.q,r.a,s.a,a.a])],e)}()}});