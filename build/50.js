webpackJsonp([50],{1861:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"CoreCommentsViewerPageModule",function(){return f});var o=n(0),r=n(4),i=n(1),c=n(1990),s=n(16),a=n(15),m=n(392),l=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},f=function(){function e(){}return e=l([Object(o.I)({declarations:[c.a],imports:[s.a,a.a,m.a,r.l.forChild(c.a),i.b.forChild()]})],e)}()},1990:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var o=n(0),r=n(4),i=n(1),c=n(2),s=n(8),a=n(26),m=n(139),l=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},f=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(){function e(e,t,n,o,r,i){this.userProvider=n,this.domUtils=o,this.translate=r,this.commentsProvider=i,this.comments=[],this.commentsLoaded=!1,this.contextLevel=e.get("contextLevel"),this.instanceId=e.get("instanceId"),this.component=e.get("component"),this.itemId=e.get("itemId"),this.area=e.get("area")||"",this.page=e.get("page")||0,this.title=e.get("title")||this.translate.instant("core.comments")}return e.prototype.ionViewDidLoad=function(){var e=this;this.fetchComments().finally(function(){e.commentsLoaded=!0})},e.prototype.fetchComments=function(){var e=this;return this.commentsProvider.getComments(this.contextLevel,this.instanceId,this.component,this.itemId,this.area,this.page).then(function(t){e.comments=t,e.comments.sort(function(e,t){return t.timecreated-e.timecreated}),e.comments.forEach(function(t){e.userProvider.getProfile(t.userid,void 0,!0).then(function(e){t.profileimageurl=e.profileimageurl})})}).catch(function(t){return t?"assignsubmission_comments"==e.component?e.domUtils.showAlertTranslated("core.notice","core.commentsnotworking"):e.domUtils.showErrorModal(t):e.domUtils.showErrorModal(e.translate.instant("core.error")+": get_comments"),Promise.reject(null)})},e.prototype.refreshComments=function(e){var t=this;this.commentsProvider.invalidateCommentsData(this.contextLevel,this.instanceId,this.component,this.itemId,this.area,this.page).finally(function(){return t.fetchComments().finally(function(){e.complete()})})},l([Object(o._9)(r.f),f("design:type",r.f)],e.prototype,"content",void 0),e=l([Object(o.m)({selector:"page-core-comments-viewer",template:'<ion-header>\n    <ion-navbar>\n        <ion-title><core-format-text [text]="title"></core-format-text></ion-title>\n    </ion-navbar>\n</ion-header>\n<ion-content>\n    <ion-refresher [enabled]="commentsLoaded" (ionRefresh)="refreshComments($event)">\n        <ion-refresher-content pullingText="{{ \'core.pulltorefresh\' | translate }}"></ion-refresher-content>\n    </ion-refresher>\n    <core-loading [hideUntil]="commentsLoaded">\n        <core-empty-box *ngIf="!comments || !comments.length" icon="chatbubbles" [message]="\'core.nocomments\' | translate"></core-empty-box>\n\n        <ion-card *ngFor="let comment of comments">\n            <ion-item text-wrap>\n                <ion-avatar item-start>\n                    <img [src]="comment.profileimageurl" onError="this.src=\'assets/img/user-avatar.png\'" core-external-content core-user-link [userId]="comment.userid" [alt]="\'core.pictureof\' | translate:{$a: comment.fullname}" role="presentation">\n                </ion-avatar>\n                <h2>{{ comment.fullname }}</h2>\n                <p>{{ comment.time }}</p>\n            </ion-item>\n            <ion-item text-wrap>\n                <core-format-text clean="true" [text]="comment.content"></core-format-text>\n            </ion-item>\n        </ion-card>\n    </core-loading>\n</ion-content>\n'}),f("design:paramtypes",[r.r,c.a,a.a,s.a,i.c,m.a])],e)}()}});